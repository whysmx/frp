(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{3713:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>ez});var r=s(5155),a=s(2115),n=s(9708),l=s(2085),d=s(2596),o=s(9688);function i(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,o.QP)((0,d.$)(t))}let c=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap text-sm font-medium ring-offset-background transition-all duration-300 ease-out focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-primary/20 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 active:scale-95 hover:scale-[1.02] [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90 rounded-2xl shadow-lg shadow-primary/20 hover:shadow-xl hover:shadow-primary/25",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90 rounded-2xl shadow-lg shadow-destructive/20 hover:shadow-xl hover:shadow-destructive/25",outline:"border border-border bg-background hover:bg-accent hover:text-accent-foreground rounded-xl",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80 rounded-xl",ghost:"hover:bg-accent hover:text-accent-foreground rounded-xl",link:"text-primary underline-offset-4 hover:underline rounded-lg"},size:{default:"h-11 px-6 py-3",sm:"h-9 px-4 py-2 rounded-xl",lg:"h-12 px-8 py-4 rounded-2xl",icon:"h-11 w-11 rounded-2xl"}},defaultVariants:{variant:"default",size:"default"}}),m=a.forwardRef((e,t)=>{let{className:s,variant:a,size:l,asChild:d=!1,...o}=e,m=d?n.DX:"button";return(0,r.jsx)(m,{className:i(c({variant:a,size:l,className:s})),ref:t,...o})});m.displayName="Button";let x=a.forwardRef((e,t)=>{let{className:s,type:a,...n}=e;return(0,r.jsx)("input",{type:a,className:i("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...n})});x.displayName="Input";let u=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("rounded-lg border bg-card text-card-foreground shadow-sm",s),...a})});u.displayName="Card",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("flex flex-col space-y-1.5 p-6",s),...a})}).displayName="CardHeader",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("text-2xl font-semibold leading-none tracking-tight",s),...a})}).displayName="CardTitle",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("text-sm text-muted-foreground",s),...a})}).displayName="CardDescription";let h=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("p-6 pt-0",s),...a})});h.displayName="CardContent",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("flex items-center p-6 pt-0",s),...a})}).displayName="CardFooter";var f=s(9613);let p=f.Kq,g=f.bL,b=f.l9,j=a.forwardRef((e,t)=>{let{className:s,sideOffset:a=4,...n}=e;return(0,r.jsx)(f.UC,{ref:t,sideOffset:a,className:i("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...n})});j.displayName=f.UC.displayName;var v=s(7924),N=s(1482),y=s(4616),w=s(1154),C=s(3717),k=s(7434);function A(e){let{sites:t,searchTerm:s,setSearchTerm:n,selectedTags:l,setSelectedTags:d,showTagFilter:o,setShowTagFilter:i,filteredSites:c,editMode:f,loading:A,onEditModeChange:S,onSaveChanges:T,onShowBatchImport:E,onShowConfigEditor:_}=e,R=(0,a.useMemo)(()=>{let e=new Set;return t.forEach(t=>{t.tags.forEach(t=>e.add(t))}),["无标签",...Array.from(e)]},[t]);return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u,{className:"glass-effect border-0 rounded-3xl card-hover",children:(0,r.jsx)(h,{className:"p-8",children:(0,r.jsxs)("div",{className:"flex flex-row gap-4",children:[(0,r.jsxs)("div",{className:"relative flex-1",children:[(0,r.jsx)(v.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-muted-foreground w-5 h-5"}),(0,r.jsx)(x,{placeholder:"搜索站点编号、名称或标签",value:s,onChange:e=>n(e.target.value),className:"pl-12 apple-input h-14 text-base placeholder:text-muted-foreground"})]}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)(m,{variant:"outline",onClick:()=>i(!o),className:"text-secondary-foreground hover:text-primary hover:bg-accent hover:border-primary border-border rounded-2xl w-12 h-12 p-0 transition-all duration-300",children:(0,r.jsx)(N.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{children:(0,r.jsx)("p",{children:"标签"})})]})})]})})}),f?(0,r.jsx)("div",{className:"fixed right-4 md:right-24 top-1/2 -translate-y-1/2 z-50 max-h-[calc(100vh-2rem)] overflow-y-auto hidden sm:block",children:(0,r.jsx)("div",{className:"bg-white/90 backdrop-blur-xl border border-border/30 rounded-3xl p-3 shadow-2xl shadow-black/10",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:_,className:"bg-warning hover:bg-warning/90 text-warning-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50 shadow-lg shadow-warning/25",disabled:A,children:(0,r.jsx)(k.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{side:"left",children:(0,r.jsx)("p",{children:"文本模式"})})]})}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:T,className:"bg-primary hover:bg-primary/90 text-primary-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50 shadow-lg shadow-primary/25",disabled:A,children:A?(0,r.jsx)(w.A,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})})}),(0,r.jsx)(j,{side:"left",children:(0,r.jsx)("p",{children:A?"保存中...":"保存"})})]})}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>S(!1),className:"bg-secondary hover:bg-secondary/80 text-secondary-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50",disabled:A,children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})}),(0,r.jsx)(j,{side:"left",children:(0,r.jsx)("p",{children:"取消"})})]})})]})})}):(0,r.jsx)("div",{className:"fixed right-4 md:right-24 top-1/2 -translate-y-1/2 z-50 max-h-[calc(100vh-2rem)] overflow-y-auto hidden sm:block",children:(0,r.jsx)("div",{className:"bg-white/90 backdrop-blur-xl border border-border/30 rounded-3xl p-3 shadow-2xl shadow-black/10",children:(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:E,className:"bg-success hover:bg-success/90 text-success-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50 shadow-lg shadow-success/25",disabled:A,children:(0,r.jsx)(y.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{side:"left",children:(0,r.jsx)("p",{children:"导入"})})]})}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>S(!0),className:"bg-background hover:bg-accent text-foreground border border-border rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50",disabled:A,children:A?(0,r.jsx)(w.A,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)(C.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{side:"left",children:(0,r.jsx)("p",{children:"修改"})})]})})]})})}),(0,r.jsx)("div",{className:"sm:hidden fixed bottom-4 left-4 right-4 z-50",children:(0,r.jsx)("div",{className:"bg-white/90 backdrop-blur-xl border border-border/30 rounded-3xl p-3 shadow-2xl shadow-black/10",children:(0,r.jsx)("div",{className:"flex justify-center gap-3",children:f?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:_,className:"bg-warning hover:bg-warning/90 text-warning-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50 shadow-lg shadow-warning/25",disabled:A,children:(0,r.jsx)(k.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{children:(0,r.jsx)("p",{children:"文本模式"})})]})}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:T,className:"bg-primary hover:bg-primary/90 text-primary-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50 shadow-lg shadow-primary/25",disabled:A,children:A?(0,r.jsx)(w.A,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M5 13l4 4L19 7"})})})}),(0,r.jsx)(j,{children:(0,r.jsx)("p",{children:A?"保存中...":"保存"})})]})}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>S(!1),className:"bg-secondary hover:bg-secondary/80 text-secondary-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50",disabled:A,children:(0,r.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2.5,d:"M6 18L18 6M6 6l12 12"})})})}),(0,r.jsx)(j,{children:(0,r.jsx)("p",{children:"取消"})})]})})]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:E,className:"bg-success hover:bg-success/90 text-success-foreground rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50 shadow-lg shadow-success/25",disabled:A,children:(0,r.jsx)(y.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{children:(0,r.jsx)("p",{children:"导入"})})]})}),(0,r.jsx)(p,{children:(0,r.jsxs)(g,{children:[(0,r.jsx)(b,{asChild:!0,children:(0,r.jsx)("button",{onClick:()=>S(!0),className:"bg-background hover:bg-accent text-foreground border border-border rounded-2xl w-11 h-11 flex items-center justify-center transition-all duration-300 active:scale-95 hover:scale-105 disabled:opacity-50",disabled:A,children:A?(0,r.jsx)(w.A,{className:"w-5 h-5 animate-spin"}):(0,r.jsx)(C.A,{className:"w-5 h-5"})})}),(0,r.jsx)(j,{children:(0,r.jsx)("p",{children:"修改"})})]})})]})})})}),o&&(0,r.jsx)(u,{className:"glass-effect border-0 rounded-3xl animated-element card-hover",children:(0,r.jsx)(h,{className:"p-8",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex flex-wrap gap-3",children:R.map(e=>{let s=l.includes(e),a="无标签"===e?t.filter(e=>0===e.tags.length).length:t.filter(t=>t.tags.includes(e)).length;return(0,r.jsxs)(m,{variant:s?"default":"outline",size:"sm",onClick:()=>{s?d(l.filter(t=>t!==e)):d([...l,e])},className:"rounded-full px-5 py-2.5 text-sm font-medium animated-element transition-all duration-300 ".concat(s?"bg-primary text-primary-foreground border-0 scale-105 shadow-lg shadow-primary/25":"bg-accent hover:bg-accent/80 text-accent-foreground border border-border scale-100"),children:[e," (",a,")"]},e)})}),l.length>0&&(0,r.jsx)("div",{className:"pt-6 border-t border-border",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("span",{className:"caption text-muted-foreground",children:["已选择 ",l.length," 个标签，匹配 ",c.length," 个站点"]}),(0,r.jsx)(m,{variant:"outline",size:"sm",onClick:()=>d([]),className:"border-border text-muted-foreground bg-background hover:bg-accent hover:text-accent-foreground rounded-2xl px-4 py-2",children:"清除"})]})})]})})})]})}let S=(0,l.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function T(e){let{className:t,variant:s,...a}=e;return(0,r.jsx)("div",{className:i(S({variant:s}),t),...a})}let E=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:t,className:i("w-full caption-bottom text-sm",s),...a})})});E.displayName="Table";let _=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("thead",{ref:t,className:i("[&_tr]:border-b",s),...a})});_.displayName="TableHeader";let R=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tbody",{ref:t,className:i("[&_tr:last-child]:border-0",s),...a})});R.displayName="TableBody",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tfoot",{ref:t,className:i("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",s),...a})}).displayName="TableFooter";let z=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("tr",{ref:t,className:i("border-b data-[state=selected]:bg-muted",s),...a})});z.displayName="TableRow";let M=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("th",{ref:t,className:i("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",s),...a})});M.displayName="TableHead";let I=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("td",{ref:t,className:i("p-4 align-middle [&:has([role=checkbox])]:pr-0",s),...a})});I.displayName="TableCell",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("caption",{ref:t,className:i("mt-4 text-sm text-muted-foreground",s),...a})}).displayName="TableCaption";var O=s(4869),F=s(1684),L=s(4213),D=s(4738),P=s(381);function U(e){let{sites:t,isEditMode:s,allTags:a,onSiteFieldChange:n,onAccessSite:l,onSSHAccess:d,onMySQLAccess:o,onShowProxyConfig:i,onAddTag:c}=e;return(0,r.jsx)(u,{className:"glass-effect border-0 rounded-3xl overflow-hidden card-hover",children:(0,r.jsx)("div",{className:"overflow-auto",children:(0,r.jsxs)(E,{children:[(0,r.jsx)(_,{className:"sticky top-0 z-10",children:(0,r.jsxs)(z,{className:"border-b border-border/50 bg-secondary/50 backdrop-blur-sm",children:[(0,r.jsx)(M,{className:"text-secondary-foreground font-medium py-8 px-10 w-60",children:"站点编号"}),(0,r.jsx)(M,{className:"text-secondary-foreground font-medium py-8 px-10 w-60",children:"站点名称"}),s&&(0,r.jsx)(M,{className:"text-secondary-foreground font-medium py-8 px-10",children:"MAC地址"}),(0,r.jsx)(M,{className:"text-secondary-foreground font-medium py-8 px-10",children:"密码"}),(0,r.jsx)(M,{className:"text-secondary-foreground font-medium py-8 px-10 w-80",children:"标签"}),(0,r.jsx)(M,{className:"text-secondary-foreground font-medium py-8 px-10 text-center",children:"操作"})]})}),(0,r.jsx)(R,{children:t.map((e,t)=>(0,r.jsxs)(z,{className:"border-b border-border/30 table-row-elevated transition-all duration-300 hover:bg-accent/30 ".concat(t%2==0?"bg-white/95":"bg-muted/20"),children:[(0,r.jsx)(I,{className:"py-8 px-10",children:s?(0,r.jsx)(x,{value:e.siteCode,onChange:t=>n(e.macAddress,"siteCode",t.target.value),className:"apple-input h-11 font-mono text-sm"}):(0,r.jsx)("span",{className:"font-mono text-sm font-medium",style:{color:"rgb(28 28 30)"},children:e.siteCode})}),(0,r.jsx)(I,{className:"py-8 px-10",children:s?(0,r.jsx)(x,{value:e.siteName,onChange:t=>n(e.macAddress,"siteName",t.target.value),className:"apple-input h-11 font-medium text-sm"}):(0,r.jsx)("span",{className:"font-medium",style:{color:"rgb(28 28 30)"},children:e.siteName})}),s&&(0,r.jsx)(I,{className:"py-8 px-10",children:(0,r.jsx)("span",{className:"font-mono text-sm",style:{color:"rgb(99 99 102)"},children:e.macAddress})}),(0,r.jsx)(I,{className:"py-8 px-10",children:s?(0,r.jsx)(x,{type:"text",value:e.password,onChange:t=>n(e.macAddress,"password",t.target.value),className:"apple-input h-11 text-sm",placeholder:"输入密码"}):(0,r.jsx)("span",{className:"text-sm font-mono font-normal",style:{color:"rgb(28 28 30)"},children:e.password||"未设置"})}),(0,r.jsx)(I,{className:"py-8 px-10",children:(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:s?(0,r.jsxs)(r.Fragment,{children:[a.map(t=>{let s=e.tags.includes(t);return(0,r.jsx)(m,{variant:s?"default":"outline",size:"sm",onClick:()=>{s?n(e.macAddress,"tags",e.tags.filter(e=>e!==t)):n(e.macAddress,"tags",[...e.tags,t])},className:"apple-button rounded-full px-4 py-2 text-xs font-normal animated-element transition-all duration-300 ".concat(s?"bg-primary text-primary-foreground border-0 scale-105":"bg-accent hover:bg-accent/80 text-accent-foreground border border-border scale-100"),children:t},t)}),(0,r.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>{let t=prompt("请输入新标签:");t&&c(e.macAddress,t)},className:"apple-button rounded-full px-4 py-2 text-xs border-2 border-dashed border-border text-muted-foreground bg-background hover:bg-accent hover:text-accent-foreground animated-element",children:[(0,r.jsx)(y.A,{className:"w-4 h-4 mr-1"}),"添加"]})]}):e.tags.map(e=>(0,r.jsx)(T,{className:"rounded-full px-4 py-2 text-xs font-normal border border-border/30 cursor-default transition-all duration-300",style:{backgroundColor:"rgb(248 248 250)",color:"rgb(28 28 30)"},children:e},e))})}),(0,r.jsx)(I,{className:"py-8 px-10 text-right",children:(0,r.jsxs)("div",{className:"flex gap-3 justify-end",children:[!s&&(()=>{let t=e.configs.find(e=>e.name.includes("-5000")),s=e.configs.find(e=>e.name.endsWith("-22")),a=e.configs.find(e=>e.name.endsWith("-3306"));return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m,{size:"sm",variant:"outline",disabled:!t,onClick:()=>t&&l(e),className:"ios-button text-foreground rounded-2xl px-3 py-2 text-xs animated-element",title:t?"访问站点":"访问站点 - 未配置网站端口(-5000)",children:(0,r.jsx)(O.A,{className:"w-4 h-4"})}),(0,r.jsx)(m,{size:"sm",variant:"outline",disabled:!s,onClick:()=>s&&d(e),className:"ios-button text-foreground rounded-2xl px-3 py-2 text-xs font-normal animated-element",title:s?"SSH连接":"SSH连接 - 未配置SSH端口(-22)",children:(0,r.jsx)(F.A,{className:"w-4 h-4"})}),(0,r.jsx)(m,{size:"sm",variant:"outline",disabled:!a,onClick:()=>a&&o(e),className:"ios-button text-foreground rounded-2xl px-3 py-2 text-xs font-normal animated-element",title:a?"MySQL连接":"MySQL连接 - 未配置MySQL端口(-3306)",children:(0,r.jsx)(L.A,{className:"w-4 h-4"})}),(0,r.jsx)(m,{size:"sm",variant:"outline",disabled:!1,onClick:()=>{console.log("BS访问: ".concat(e.siteName))},className:"ios-button text-foreground rounded-2xl px-3 py-2 text-xs font-normal animated-element",title:"BS平台",children:(0,r.jsx)(D.A,{className:"w-4 h-4"})})]})})(),s&&(0,r.jsxs)(m,{size:"sm",variant:"outline",onClick:()=>i(e),className:"ios-button text-foreground rounded-2xl px-4 py-2 text-xs font-normal animated-element",children:[(0,r.jsx)(P.A,{className:"w-4 h-4 mr-1"}),"端口配置"]})]})})]},e.macAddress))})]})})})}var B=s(2525);function H(e){let{showProxyConfig:t,setShowProxyConfig:s,onSave:n,allSites:l=[]}=e,[d,o]=(0,a.useState)([]);(0,a.useEffect)(()=>{t&&o([...t.configs])},[t]);let i=()=>{let e=18015,t=new Set;for(l.forEach(e=>{e.configs.forEach(e=>{e.bind_port>0&&t.add(e.bind_port)})}),d.forEach(e=>{e.bind_port>0&&t.add(e.bind_port)});t.has(e);)e++;return e},c=e=>{o(t=>t.filter((t,s)=>s!==e))},u=(e,t,s)=>{o(r=>r.map((r,a)=>a===e?{...r,[t]:s,bind_addr:"0.0.0.0"}:r))};return t?(0,r.jsx)("div",{className:"sticky top-4 z-20 glass-effect border-0 rounded-3xl animated-element card-hover bg-white/95 backdrop-blur-sm shadow-xl mb-6",children:(0,r.jsx)("div",{className:"p-6",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center",children:(0,r.jsx)(P.A,{className:"w-6 h-6 text-white"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"title-3",children:"端口配置"}),(0,r.jsxs)("p",{className:"caption text-foreground",children:["站点: ",t.siteName," (",t.siteCode,")"]})]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(m,{variant:"outline",onClick:()=>{s(null)},className:"border-border text-foreground bg-white/90 hover:bg-white hover:shadow-lg rounded-2xl px-6 py-3 animated-element backdrop-blur-sm",children:"取消"}),(0,r.jsx)(m,{onClick:()=>{t&&n(t,d.map(e=>{if(0===e.bind_port){let t=i();return console.log("自动分配端口: ".concat(e.name," -> ").concat(t)),{...e,bind_port:t}}return e})),s(null)},className:"button-primary animated-element font-semibold",children:"确认"})]})]}),(0,r.jsxs)(E,{className:"bg-white/70 rounded-2xl backdrop-blur-sm",children:[(0,r.jsx)(_,{children:(0,r.jsxs)(z,{className:"border-border",children:[(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"代理名称"}),(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"类型"}),(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"角色"}),(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"服务名"}),(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"密钥"}),(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"绑定端口"}),(0,r.jsx)(M,{className:"text-foreground font-semibold",children:"操作"})]})}),(0,r.jsx)(R,{children:d.map((e,t)=>(0,r.jsxs)(z,{className:"border-border hover:bg-white/80 transition-colors",children:[(0,r.jsx)(I,{children:(0,r.jsx)(x,{value:e.name,onChange:e=>u(t,"name",e.target.value),className:"bg-white/60 border-border rounded-xl"})}),(0,r.jsx)(I,{children:(0,r.jsx)(x,{value:e.type,onChange:e=>u(t,"type",e.target.value),className:"bg-white/60 border-border rounded-xl"})}),(0,r.jsx)(I,{children:(0,r.jsx)(x,{value:e.role,onChange:e=>u(t,"role",e.target.value),className:"bg-white/60 border-border rounded-xl"})}),(0,r.jsx)(I,{children:(0,r.jsx)(x,{value:e.server_name,onChange:e=>u(t,"server_name",e.target.value),className:"bg-white/60 border-border rounded-xl"})}),(0,r.jsx)(I,{children:(0,r.jsx)(x,{value:e.sk,onChange:e=>u(t,"sk",e.target.value),className:"bg-white/60 border-border rounded-xl"})}),(0,r.jsx)(I,{children:(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(x,{type:"number",value:e.bind_port,onChange:e=>u(t,"bind_port",parseInt(e.target.value)||0),placeholder:"输入0自动分配",className:"bg-white/60 border-border rounded-xl"}),0===e.bind_port&&(0,r.jsx)("div",{className:"text-xs text-muted-foreground",children:"保存时自动分配端口"})]})}),(0,r.jsx)(I,{children:(0,r.jsx)(m,{variant:"destructive",size:"sm",onClick:()=>c(t),className:"rounded-xl",children:(0,r.jsx)(B.A,{className:"w-4 h-4"})})})]},t))})]}),(0,r.jsxs)(m,{onClick:()=>{let e={name:"",type:"stcp",role:"visitor",server_name:"",sk:(null==t?void 0:t.macAddress)||"",bind_addr:"0.0.0.0",bind_port:0};o(t=>[...t,e])},variant:"outline",className:"w-full border-dashed border-2 border-border text-foreground hover:bg-accent rounded-2xl py-4 animated-element",children:[(0,r.jsx)(y.A,{className:"w-5 h-5 mr-2"}),"新增端口配置"]})]})})}):null}var V=s(5452),W=s(4416);let Q=V.bL;V.l9;let J=V.ZL;V.bm;let q=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(V.hJ,{ref:t,className:i("fixed inset-0 z-50 bg-black/40 backdrop-blur-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 transition-all duration-300",s),...a})});q.displayName=V.hJ.displayName;let Y=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(J,{children:[(0,r.jsx)(q,{}),(0,r.jsxs)(V.UC,{ref:t,className:i("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-6 border border-border/50 bg-background/95 backdrop-blur-xl p-8 shadow-2xl shadow-black/20 duration-300 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-3xl",s),...n,children:[a,(0,r.jsxs)(V.bm,{className:"absolute right-6 top-6 rounded-xl p-2 opacity-70 ring-offset-background transition-all duration-300 hover:opacity-100 hover:bg-accent focus:outline-none focus:ring-2 focus:ring-primary/20 focus:ring-offset-2 disabled:pointer-events-none",children:[(0,r.jsx)(W.A,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});Y.displayName=V.UC.displayName;let G=e=>{let{className:t,...s}=e;return(0,r.jsx)("div",{className:i("flex flex-col space-y-3 text-center sm:text-left",t),...s})};G.displayName="DialogHeader";let X=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(V.hE,{ref:t,className:i("text-xl font-bold leading-tight tracking-tight text-foreground",s),...a})});X.displayName=V.hE.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(V.VY,{ref:t,className:i("text-sm text-muted-foreground",s),...a})}).displayName=V.VY.displayName;var Z=s(968);let $=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),K=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(Z.b,{ref:t,className:i($(),s),...a})});K.displayName=Z.b.displayName;let ee=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("textarea",{className:i("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...a})});ee.displayName="Textarea";var et=s(330),es=s(6474),er=s(7863),ea=s(5196);let en=et.bL;et.YJ;let el=et.WT,ed=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(et.l9,{ref:t,className:i("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",s),...n,children:[a,(0,r.jsx)(et.In,{asChild:!0,children:(0,r.jsx)(es.A,{className:"h-4 w-4 opacity-50"})})]})});ed.displayName=et.l9.displayName;let eo=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(et.PP,{ref:t,className:i("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(er.A,{className:"h-4 w-4"})})});eo.displayName=et.PP.displayName;let ei=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(et.wn,{ref:t,className:i("flex cursor-default items-center justify-center py-1",s),...a,children:(0,r.jsx)(es.A,{className:"h-4 w-4"})})});ei.displayName=et.wn.displayName;let ec=a.forwardRef((e,t)=>{let{className:s,children:a,position:n="popper",...l}=e;return(0,r.jsx)(et.ZL,{children:(0,r.jsxs)(et.UC,{ref:t,className:i("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===n&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",s),position:n,...l,children:[(0,r.jsx)(eo,{}),(0,r.jsx)(et.LM,{className:i("p-1","popper"===n&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,r.jsx)(ei,{})]})})});ec.displayName=et.UC.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(et.JU,{ref:t,className:i("py-1.5 pl-8 pr-2 text-sm font-semibold",s),...a})}).displayName=et.JU.displayName;let em=a.forwardRef((e,t)=>{let{className:s,children:a,...n}=e;return(0,r.jsxs)(et.q7,{ref:t,className:i("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),...n,children:[(0,r.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,r.jsx)(et.VF,{children:(0,r.jsx)(ea.A,{className:"h-4 w-4"})})}),(0,r.jsx)(et.p4,{children:a})]})});em.displayName=et.q7.displayName,a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)(et.wv,{ref:t,className:i("-mx-1 my-1 h-px bg-muted",s),...a})}).displayName=et.wv.displayName;let ex=(0,l.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),eu=a.forwardRef((e,t)=>{let{className:s,variant:a,...n}=e;return(0,r.jsx)("div",{ref:t,role:"alert",className:i(ex({variant:a}),s),...n})});eu.displayName="Alert",a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("h5",{ref:t,className:i("mb-1 font-medium leading-none tracking-tight",s),...a})}).displayName="AlertTitle";let eh=a.forwardRef((e,t)=>{let{className:s,...a}=e;return(0,r.jsx)("div",{ref:t,className:i("text-sm [&_p]:leading-relaxed",s),...a})});eh.displayName="AlertDescription";let ef=0,ep=new Map,eg=e=>{if(ep.has(e))return;let t=setTimeout(()=>{ep.delete(e),eN({type:"REMOVE_TOAST",toastId:e})},1e6);ep.set(e,t)},eb=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:s}=t;return s?eg(s):e.toasts.forEach(e=>{eg(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},ej=[],ev={toasts:[]};function eN(e){ev=eb(ev,e),ej.forEach(e=>{e(ev)})}function ey(e){let{...t}=e,s=(ef=(ef+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>eN({type:"DISMISS_TOAST",toastId:s});return eN({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:e=>{e||r()}}}),{id:s,dismiss:r,update:e=>eN({type:"UPDATE_TOAST",toast:{...e,id:s}})}}var ew=s(9869),eC=s(5339);let ek=[{value:"unselected",label:"选择字段..."},{value:"siteCode",label:"站点编号"},{value:"siteName",label:"站点名称"},{value:"macAddress",label:"MAC地址"},{value:"password",label:"密码"},{value:"tags",label:"标签"},{value:"ignore",label:"忽略此列"}],eA=["siteCode","siteName","macAddress"];function eS(e){let{showBatchImport:t,setShowBatchImport:s,onImport:n}=e,[l,d]=(0,a.useState)(""),[o,i]=(0,a.useState)({}),[c,x]=(0,a.useState)(!1),{toast:u}=function(){let[e,t]=a.useState(ev);return a.useEffect(()=>(ej.push(t),()=>{let e=ej.indexOf(t);e>-1&&ej.splice(e,1)}),[e]),{...e,toast:ey,dismiss:e=>eN({type:"DISMISS_TOAST",toastId:e})}}(),h=(0,a.useMemo)(()=>{if(!l.trim())return[];let e=l.trim().split("\n");if(0===e.length)return[];let t=" ",s=0;for(let r of["|","	"," "]){let a=e[0].split(r).length;if(a>1){let n=e.map(e=>e.split(r).length),l=n.reduce((e,t)=>e+t,0)/n.length;a>=s&&1>Math.abs(a-l)&&(t=r,s=a)}}return e.map(e=>e.split(t).map(e=>e.trim())).filter(e=>e.some(e=>e.length>0))},[l]),f=(0,a.useMemo)(()=>Math.max(0,...h.map(e=>e.length)),[h]),p=(0,a.useMemo)(()=>{if(0===f)return{};let e={},t=["siteName","siteCode","macAddress","password","tags"];for(let s=0;s<Math.min(f,t.length);s++)e[s]=t[s];for(let s=t.length;s<f;s++)e[s]="tags";return e},[f]),g=(0,a.useMemo)(()=>{let e={...p};return Object.entries(o).forEach(t=>{let[s,r]=t;r&&"unselected"!==r&&(e[parseInt(s)]=r)}),e},[p,o]),b=(0,a.useMemo)(()=>{let e=[],t=Object.values(g).filter(e=>e&&"ignore"!==e&&"unselected"!==e);for(let r of eA)if(!t.includes(r)){var s;let t=null===(s=ek.find(e=>e.value===r))||void 0===s?void 0:s.label;e.push("缺少必填字段：".concat(t))}let r=t.filter((e,s)=>t.indexOf(e)!==s);return r.length>0&&e.push("重复映射字段：".concat(r.join(", "))),e},[g]),j=(e,t)=>{i(s=>({...s,[e]:t}))},v=e=>{let t=Object.entries(g).filter(t=>{let[s,r]=t;return parseInt(s)!==e&&r&&"ignore"!==r&&"unselected"!==r&&"tags"!==r}).map(e=>{let[,t]=e;return t});return ek.filter(e=>"unselected"===e.value||"ignore"===e.value||"tags"===e.value||!t.includes(e.value))},N=()=>{let e=[],t=18015;for(let s of h)try{let r={};if(Object.entries(g).forEach(e=>{let[t,a]=e,n=s[parseInt(t)]||"";if("tags"===a){let e=r.tags||[],t=n?n.split(",").map(e=>e.trim()).filter(e=>e):[];r.tags=[...e,...t]}else a&&"ignore"!==a&&"unselected"!==a&&(r[a]=n)}),!r.siteCode||!r.siteName||!r.macAddress||!r.macAddress.match(/^[A-F0-9]{12}$/i))continue;let a=[{name:"E-".concat(r.macAddress,"-22"),type:"stcp",role:"visitor",server_name:"E-".concat(r.macAddress,"-22"),sk:r.macAddress,bind_addr:"0.0.0.0",bind_port:t++},{name:"E-".concat(r.macAddress,"-3306"),type:"stcp",role:"visitor",server_name:"E-".concat(r.macAddress,"-3306"),sk:r.macAddress,bind_addr:"0.0.0.0",bind_port:t++},{name:"E-".concat(r.macAddress,"-5000"),type:"stcp",role:"visitor",server_name:"E-".concat(r.macAddress,"-5000"),sk:r.macAddress,bind_addr:"0.0.0.0",bind_port:t++}],n={macAddress:r.macAddress,siteCode:r.siteCode,siteName:r.siteName,password:r.password||"",tags:r.tags||[],configs:a};e.push(n)}catch(e){console.warn("Failed to process row:",s,e)}return e},y=async()=>{if(b.length>0){u({title:"映射错误",description:b[0],variant:"destructive"});return}let e=N();if(0===e.length){u({title:"导入失败",description:"没有找到有效的站点数据",variant:"destructive"});return}x(!0);try{await n(e),u({title:"导入成功",description:"成功导入 ".concat(e.length," 个站点")}),d(""),i({}),s(!1)}catch(e){u({title:"导入失败",description:e instanceof Error?e.message:"未知错误",variant:"destructive"})}finally{x(!1)}};return(0,r.jsx)(Q,{open:t,onOpenChange:s,children:(0,r.jsxs)(Y,{className:"max-w-[90vw] w-[90%] max-h-[90vh]",children:[(0,r.jsx)(G,{children:(0,r.jsxs)(X,{className:"flex items-center gap-2",children:[(0,r.jsx)(ew.A,{className:"h-5 w-5"}),"批量导入站点"]})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)(K,{htmlFor:"importData",className:"text-sm font-semibold",children:"导入数据"}),(0,r.jsx)(m,{variant:"outline",size:"sm",onClick:()=>{d("苏州辐射站|DC001|E721EE345A01|pass123|测试,在线,重要\n南京监测点|DC002|E721EE345A02|pass456|生产,稳定\n无锡数据中心|DC003|E721EE345A03|pass789|重要,维护,关键,核心"),i({}),u({title:"示例数据已加载",description:"请为每列选择对应的字段"})},className:"text-xs",children:"加载示例"})]}),(0,r.jsx)(ee,{id:"importData",value:l,onChange:e=>d(e.target.value),placeholder:"请粘贴数据，每行一个站点，支持 竖线 制表符 空格 分隔，标签内用逗号分隔...",rows:6,className:"apple-input resize-none font-mono text-sm"})]}),h.length>0&&(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(K,{className:"text-sm font-semibold",children:"列映射"}),(0,r.jsx)("div",{className:"border rounded-lg overflow-hidden",children:(0,r.jsx)("div",{className:"max-h-64 overflow-y-auto",children:(0,r.jsxs)(E,{children:[(0,r.jsx)(_,{children:(0,r.jsx)(z,{children:Array.from({length:f},(e,t)=>(0,r.jsx)(M,{className:"min-w-[150px]",children:(0,r.jsxs)(en,{value:g[t]||"unselected",onValueChange:e=>j(t,e),children:[(0,r.jsx)(ed,{className:"h-8 text-xs",children:(0,r.jsx)(el,{placeholder:"选择字段"})}),(0,r.jsx)(ec,{children:v(t).map(e=>(0,r.jsx)(em,{value:e.value,children:e.label},e.value))})]})},t))})}),(0,r.jsxs)(R,{children:[h.slice(0,5).map((e,t)=>(0,r.jsx)(z,{children:Array.from({length:f},(t,s)=>(0,r.jsx)(I,{className:"text-xs font-mono",children:e[s]||""},s))},t)),h.length>5&&(0,r.jsx)(z,{children:(0,r.jsxs)(I,{colSpan:f,className:"text-center text-xs text-muted-foreground",children:["... 还有 ",h.length-5," 行数据"]})})]})]})})})]}),b.length>0&&(0,r.jsxs)(eu,{variant:"destructive",children:[(0,r.jsx)(eC.A,{className:"h-4 w-4"}),(0,r.jsx)(eh,{children:(0,r.jsx)("ul",{className:"list-disc list-inside space-y-1",children:b.map((e,t)=>(0,r.jsx)("li",{className:"text-sm",children:e},t))})})]}),(0,r.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,r.jsx)(m,{variant:"outline",onClick:()=>s(!1),className:"flex-1",children:"取消"}),(0,r.jsx)(m,{onClick:y,disabled:!h.length||b.length>0||c,className:"flex-1",children:c?"导入中...":"导入 ".concat(h.length," 个站点")})]})]})]})})}var eT=s(3904),eE=s(6671);function e_(e){let{showConfigEditor:t,setShowConfigEditor:s}=e,[n,l]=(0,a.useState)("");(0,a.useEffect)(()=>{t&&d()},[t]);let d=()=>{fetch("/api/config",{credentials:"include"}).then(e=>e.text()).then(e=>{l(e)}).catch(e=>{eE.oR.error("Get configure content from frpc failed!")})};return(0,r.jsx)(Q,{open:t,onOpenChange:s,children:(0,r.jsxs)(Y,{className:"sm:max-w-4xl max-h-[80vh]",children:[(0,r.jsx)(G,{children:(0,r.jsx)(X,{children:"修改配置文件"})}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex gap-2 mb-4",children:[(0,r.jsxs)(m,{variant:"outline",onClick:d,children:[(0,r.jsx)(eT.A,{className:"w-4 h-4 mr-2"}),"刷新"]}),(0,r.jsx)(m,{onClick:()=>{if(""===n){eE.oR.error("Configure content can not be empty!");return}fetch("/api/config",{credentials:"include",method:"PUT",body:n}).then(()=>{fetch("/api/reload",{credentials:"include"}).then(()=>{eE.oR.success("Success"),s(!1)}).catch(e=>{eE.oR.error("Reload frpc configure file error, "+e)})}).catch(e=>{eE.oR.error("Put config to frpc and hot reload failed!")})},children:"上传"})]}),(0,r.jsx)(ee,{value:n,onChange:e=>l(e.target.value),placeholder:"frpc configure file, can not be empty...",rows:20,className:"font-mono text-sm text-black"})]})]})})}var eR=s(7100);function ez(){let{state:e,actions:t}=(0,eR.i)(),[s,n]=(0,a.useState)(!1),[l,d]=(0,a.useState)(!1),[o,i]=(0,a.useState)(!1),[c,m]=(0,a.useState)(null);(0,a.useEffect)(()=>{t.loadSites()},[]);let{sites:x,filteredSites:u,loading:h,error:f,editMode:p,searchTerm:g,selectedTags:b,allTags:j,lastSyncTime:v}=e,N=async(e,s,r)=>{try{await t.updateSite(e,{[s]:r},!0)}catch(e){console.error("Failed to update site:",e)}},y=async e=>{try{await t.importSites(e)}catch(e){console.error("Failed to import sites:",e)}},w=async(e,s)=>{try{await t.updateSite(e.macAddress,{configs:s}),m({...e,configs:s})}catch(e){console.error("Failed to save proxy config:",e)}},C=async(e,s)=>{if(s.trim()){let r=x.find(t=>t.macAddress===e);if(r&&!r.tags.includes(s.trim()))try{await t.updateSite(e,{tags:[...r.tags,s.trim()]},!0)}catch(e){console.error("Failed to add tag:",e)}}},k=async()=>{try{await t.saveSites(),t.setEditMode(!1)}catch(e){console.error("Failed to save changes:",e)}};return f?(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4",children:(0,r.jsx)("div",{className:"max-w-[90rem] mx-auto space-y-8",children:(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-red-600 mb-4",children:"连接失败"}),(0,r.jsx)("p",{className:"text-gray-600 mb-6",children:f})]})})}):(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-4 pb-20 sm:pb-4",children:(0,r.jsxs)("div",{className:"max-w-[90rem] mx-auto space-y-8",children:[(0,r.jsx)(A,{sites:x,searchTerm:g,setSearchTerm:t.setSearchTerm,selectedTags:b,setSelectedTags:t.setSelectedTags,showTagFilter:s,setShowTagFilter:n,filteredSites:u,editMode:p,loading:h,onEditModeChange:t.setEditMode,onSaveChanges:k,onShowBatchImport:()=>d(!0),onShowConfigEditor:()=>i(!0)}),(0,r.jsx)(H,{showProxyConfig:c,setShowProxyConfig:m,onSave:w,allSites:x}),(0,r.jsx)(U,{sites:u,isEditMode:p,allTags:j,onSiteFieldChange:N,onAccessSite:e=>{let t=e.configs.find(e=>e.name.includes("-5000"));if(t){let s="http://localhost:".concat(t.bind_port),r="".concat(s,"?site=").concat(encodeURIComponent(e.siteCode),".").concat(encodeURIComponent(e.siteName));window.open(r,"_blank")}},onSSHAccess:e=>{let t=e.configs.find(e=>e.name.endsWith("-22"));if(t){let s=window.location.hostname,r="".concat(e.siteCode,".").concat(e.siteName),a='xshell -newtab "'.concat(r,'" ssh forlinx@').concat(s," -p ").concat(t.bind_port);navigator.clipboard.writeText(a);let n=document.createElement("div");n.textContent="SSH命令已复制 (标签: ".concat(r,")"),n.style.cssText="\n        position: fixed; top: 20px; right: 20px; z-index: 9999;\n        background: rgba(0, 0, 0, 0.8); color: white; padding: 12px 16px;\n        border-radius: 8px; font-size: 14px; max-width: 400px;\n        animation: fadeInOut 3s forwards;\n      ",document.body.appendChild(n),setTimeout(()=>n.remove(),3e3)}else{let e=document.createElement("div");e.textContent="未找到SSH端口配置（后缀-22）",e.style.cssText="\n        position: fixed; top: 20px; right: 20px; z-index: 9999;\n        background: rgba(220, 38, 38, 0.9); color: white; padding: 12px 16px;\n        border-radius: 8px; font-size: 14px; max-width: 400px;\n        animation: fadeInOut 3s forwards;\n      ",document.body.appendChild(e),setTimeout(()=>e.remove(),3e3)}},onMySQLAccess:e=>{let t=e.configs.find(e=>e.name.endsWith("-3306"));if(t){let s=window.location.hostname,r="".concat(e.siteCode,".").concat(e.siteName),a="mysql://root:Sun%40123456@".concat(s,":").concat(t.bind_port,"/");navigator.clipboard.writeText(a);let n=document.createElement("div");n.textContent="MySQL连接信息已复制 (".concat(r,")"),n.style.cssText="\n        position: fixed; top: 20px; right: 20px; z-index: 9999;\n        background: rgba(0, 0, 0, 0.8); color: white; padding: 12px 16px;\n        border-radius: 8px; font-size: 14px; max-width: 400px;\n        animation: fadeInOut 3s forwards;\n      ",document.body.appendChild(n),setTimeout(()=>n.remove(),3e3)}else{let e=document.createElement("div");e.textContent="未找到MySQL端口配置（后缀-3306）",e.style.cssText="\n        position: fixed; top: 20px; right: 20px; z-index: 9999;\n        background: rgba(220, 38, 38, 0.9); color: white; padding: 12px 16px;\n        border-radius: 8px; font-size: 14px; max-width: 400px;\n        animation: fadeInOut 3s forwards;\n      ",document.body.appendChild(e),setTimeout(()=>e.remove(),3e3)}},onShowProxyConfig:e=>{m(e)},onAddTag:C}),(0,r.jsx)(eS,{showBatchImport:l,setShowBatchImport:d,onImport:y}),(0,r.jsx)(e_,{showConfigEditor:o,setShowConfigEditor:i})]})})}},4751:(e,t,s)=>{Promise.resolve().then(s.bind(s,3713))}},e=>{var t=t=>e(e.s=t);e.O(0,[671,383,100,441,684,358],()=>t(4751)),_N_E=e.O()}]);